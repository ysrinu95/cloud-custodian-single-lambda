{
  "version": "1.0",
  "description": "Multi-Account Cloud Custodian Policy Mapping with Global and Account-Specific Configurations",
  "generated_at": "2024-01-01T00:00:00Z",
  "statistics": {
    "total_policies": 5,
    "event_driven_policies": 5,
    "unique_events": 2,
    "managed_accounts": 2
  },
  "event_mapping": {
    "GuardDuty Finding": [
      {
        "policy_name": "guardduty-findings-remediation",
        "resource": "aws.guardduty-finding",
        "source_file": "aws-guardduty-findings-remediate.yml",
        "description": "Real-time GuardDuty threat detection and notification"
      },
      {
        "policy_name": "guardduty-backdoor-ec2-isolation",
        "resource": "aws.ec2",
        "source_file": "aws-guardduty-findings-remediate.yml",
        "description": "Isolate EC2 instances with backdoor/trojan detections"
      },
      {
        "policy_name": "guardduty-cryptocurrency-ec2-termination",
        "resource": "aws.ec2",
        "source_file": "aws-guardduty-findings-remediate.yml",
        "description": "Terminate EC2 instances involved in cryptocurrency mining"
      },
      {
        "policy_name": "guardduty-unauthorized-iam-remediation",
        "resource": "aws.iam-user",
        "source_file": "aws-guardduty-findings-remediate.yml",
        "description": "Disable compromised IAM users and access keys"
      }
    ]
  },
  "account_mapping": {
    "172327596604": {
      "name": "srini-optum (Central Management Account)",
      "environment": "production",
      "description": "Central management account hosting Cloud Custodian Lambda with strict security controls",
      "event_mapping": {
        "GuardDuty Finding": [
          {
            "policy_name": "guardduty-findings-remediation",
            "resource": "aws.guardduty-finding",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "auto-remediate",
            "description": "Central Account: Real-time GuardDuty threat notification"
          },
          {
            "policy_name": "guardduty-backdoor-ec2-isolation",
            "resource": "aws.ec2",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "strict",
            "description": "Central Account: Immediately isolate backdoor/trojan infected instances"
          },
          {
            "policy_name": "guardduty-cryptocurrency-ec2-termination",
            "resource": "aws.ec2",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "strict",
            "description": "Central Account: Terminate crypto mining instances"
          },
          {
            "policy_name": "guardduty-unauthorized-iam-remediation",
            "resource": "aws.iam-user",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "strict",
            "description": "Central Account: Disable compromised IAM credentials"
          }
        ]
      },
      "iam_role": "arn:aws:iam::172327596604:role/CloudCustodian-CrossAccount-ExecutionRole",
      "external_id": "cloud-custodian-172327596604"
    },
    "813185901390": {
      "name": "Cloud Custodian Test Member",
      "environment": "test",
      "description": "Member test account for validating cross-account Cloud Custodian execution",
      "event_mapping": {
        "GuardDuty Finding": [
          {
            "policy_name": "guardduty-findings-remediation",
            "resource": "aws.guardduty-finding",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "notify",
            "description": "Test Account: Real-time GuardDuty threat notification"
          },
          {
            "policy_name": "guardduty-backdoor-ec2-isolation",
            "resource": "aws.ec2",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "notify",
            "description": "Test Account: Notify on backdoor/trojan detections"
          },
          {
            "policy_name": "guardduty-cryptocurrency-ec2-termination",
            "resource": "aws.ec2",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "notify",
            "description": "Test Account: Notify on crypto mining detections"
          },
          {
            "policy_name": "guardduty-unauthorized-iam-remediation",
            "resource": "aws.iam-user",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "notify",
            "description": "Test Account: Notify on compromised IAM credentials"
          }
        ]
      },
      "iam_role": "arn:aws:iam::813185901390:role/CloudCustodianExecutionRole",
      "external_id": "cloud-custodian-813185901390",
      "notes": "Test member account for cross-account Cloud Custodian validation and testing"
    }
  },
  "policies": {
    "aws-ec2-stop-public-instances": {
      "resource": "aws.ec2",
      "source_file": "aws-ec2-stop-public-instances.yml",
      "mode_type": "cloudtrail",
      "description": "Notifies of and stops EC2 instances launched in a public subnet",
      "severity": "high",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "s3-public-bucket-remediation-realtime": {
      "resource": "aws.s3",
      "source_file": "s3-public-bucket-remediation-realtime.yml",
      "mode_type": "cloudtrail",
      "description": "Monitor S3 buckets in real-time and automatically secure public buckets",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "security-hub-findings-notification": {
      "resource": "aws.security-hub-finding",
      "source_file": "security-hub-findings-notification.yml",
      "mode_type": "cloudtrail",
      "description": "Monitor Security Hub findings in real-time and notify on HIGH and CRITICAL severity findings",
      "severity": "variable",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security"]
    },
    "guardduty-findings-remediation": {
      "resource": "aws.guardduty-finding",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "event-driven",
      "description": "Real-time GuardDuty threat detection and automated remediation",
      "severity": "high",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security", "PCI-DSS"]
    },
    "guardduty-backdoor-ec2-isolation": {
      "resource": "aws.ec2",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "event-driven",
      "description": "Isolate EC2 instances with backdoor/C&C communication",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security", "PCI-DSS"]
    },
    "guardduty-cryptocurrency-ec2-termination": {
      "resource": "aws.ec2",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "event-driven",
      "description": "Terminate EC2 instances involved in cryptocurrency mining",
      "severity": "high",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security"]
    },
    "guardduty-unauthorized-iam-remediation": {
      "resource": "aws.iam-user",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "event-driven",
      "description": "Disable IAM users and access keys involved in unauthorized access",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security", "PCI-DSS", "HIPAA"]
    }
  },
  "enforcement_levels": {
    "strict": "Immediate automated remediation without notification delay",
    "auto-remediate": "Automated remediation with notification",
    "moderate": "Partial remediation with manual review options",
    "notify": "Notification only, manual remediation required",
    "notify-only": "Notification without any automated action"
  },
  "metadata": {
    "version": "2.0.0",
    "last_updated": "2025-11-20T00:00:00Z",
    "author": "Cloud Custodian Team",
    "description": "Multi-tier policy mapping supporting global defaults and account-specific overrides for intelligent cross-account policy execution",
    "central_account_id": "172327596604",
    "member_account_ids": ["813185901390"]
  }
}
