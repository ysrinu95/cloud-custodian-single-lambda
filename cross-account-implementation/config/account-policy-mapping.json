{
  "version": "1.0",
  "description": "Multi-Account Cloud Custodian Policy Mapping with Global and Account-Specific Configurations",
  "generated_at": "2024-01-01T00:00:00Z",
  "statistics": {
    "total_policies": 59,
    "event_driven_policies": 17,
    "periodic_policies": 42,
    "unique_events": 12,
    "managed_accounts": 2
  },
  "event_mapping": {
    "GuardDuty Finding": [
      {
        "policy_name": "guardduty-findings-auto-archive",
        "resource": "aws.guardduty-finding",
        "source_file": "aws-guardduty-findings-remediate.yml",
        "description": "Notify on high-severity GuardDuty threats"
      }
    ],
    "DeleteObject": [
      {
        "policy_name": "s3-mass-deletion-detection",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Detect mass S3 object deletion (data destruction)"
      }
    ],
    "GetObject": [
      {
        "policy_name": "s3-request-spike-detection",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Detect spike in S3 API requests (exfiltration/DoS)"
      },
      {
        "policy_name": "s3-data-transfer-cost-alert",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Alert on high S3 data transfer (billing spike)"
      }
    ],
    "ListBucket": [
      {
        "policy_name": "s3-request-spike-detection",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Detect spike in S3 API requests (exfiltration/DoS)"
      }
    ],
    "CreateBucket": [
      {
        "policy_name": "s3-no-server-side-encryption",
        "resource": "aws.s3",
        "source_file": "aws-s3-security",
        "description": "Auto-enable encryption on newly created buckets"
      }
    ],
    "PutBucketEncryption": [
      {
        "policy_name": "s3-no-server-side-encryption",
        "resource": "aws.s3",
        "source_file": "aws-s3-security",
        "description": "Monitor encryption configuration changes"
      }
    ],
    "DeleteBucketEncryption": [
      {
        "policy_name": "s3-no-server-side-encryption",
        "resource": "aws.s3",
        "source_file": "aws-s3-security",
        "description": "Detect removal of bucket encryption"
      }
    ],
    "PutBucketPolicy": [
      {
        "policy_name": "s3-bucket-policy-modification",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Detect unauthorized bucket policy changes"
      }
    ],
    "DeleteBucketPolicy": [
      {
        "policy_name": "s3-bucket-policy-modification",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Detect unauthorized bucket policy changes"
      }
    ],
    "PutBucketAcl": [
      {
        "policy_name": "s3-bucket-policy-modification",
        "resource": "aws.account",
        "source_file": "aws-s3-anomaly-detection.yml",
        "description": "Detect unauthorized bucket ACL changes"
      }
    ],
    "CloudWatch Alarm State Change": [
      {
        "policy_name": "s3-delete-requests-spike-alarm",
        "resource": "aws.account",
        "source_file": "aws-s3-cloudwatch-metrics.yml",
        "description": "Alert on S3 delete requests spike (mass deletion)"
      },
      {
        "policy_name": "s3-data-transfer-cost-spike-alarm",
        "resource": "aws.account",
        "source_file": "aws-s3-cloudwatch-metrics.yml",
        "description": "Alert on S3 data transfer cost anomaly (exfiltration)"
      },
      {
        "policy_name": "s3-bucket-size-growth-alarm",
        "resource": "aws.account",
        "source_file": "aws-s3-cloudwatch-metrics.yml",
        "description": "Alert on unusual bucket size growth"
      },
      {
        "policy_name": "s3-4xx-error-spike-alarm",
        "resource": "aws.account",
        "source_file": "aws-s3-cloudwatch-metrics.yml",
        "description": "Alert on S3 4xx error spike (reconnaissance)"
      }
    ],
    "CreateLoadBalancer": [
      {
        "policy_name": "alb-http-no-redirect-to-https",
        "resource": "aws.app-elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of ALB with HTTP listener without HTTPS redirect"
      },
      {
        "policy_name": "elbv2-no-tls-listener",
        "resource": "aws.app-elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of ALB/NLB created without TLS listener"
      }
    ],
    "CreateListener": [
      {
        "policy_name": "alb-http-no-redirect-to-https",
        "resource": "aws.app-elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of HTTP listener without HTTPS redirect"
      },
      {
        "policy_name": "alb-outdated-ssl-policy",
        "resource": "aws.app-elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of ALB using outdated SSL/TLS policy"
      }
    ],
    "ModifyListener": [
      {
        "policy_name": "alb-http-no-redirect-to-https",
        "resource": "aws.app-elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of listener modification removing HTTPS redirect"
      },
      {
        "policy_name": "alb-outdated-ssl-policy",
        "resource": "aws.app-elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of listener SSL policy downgrade"
      }
    ],
    "ModifyLoadBalancerAttributes": [
      {
        "policy_name": "elb-logging-not-central-bucket",
        "resource": "aws.elb",
        "source_file": "aws-alb-security",
        "description": "Real-time detection of ELB logging configuration changes"
      }
    ]
  },
  "account_mapping": {
    "172327596604": {
      "name": "srini-optum (Central Management Account)",
      "environment": "production",
      "description": "Central management account hosting Cloud Custodian Lambda with strict security controls",
      "periodic_policies": [
        "alb-http-no-redirect-to-https",
        "alb-outdated-ssl-policy",
        "elb-logging-not-central-bucket",
        "elbv2-no-tls-listener",
        "nlb-outdated-ssl-policy",
        "ami-publicly-accessible",
        "ebs-snapshot-unencrypted",
        "ebs-snapshot-public",
        "ec2-unencrypted-ebs-volume",
        "ec2-instance-older-than-30-days",
        "ec2-imdsv1-enabled",
        "sg-allow-ssh-from-internet",
        "sg-allow-rdp-from-internet",
        "sg-allow-cifs-from-internet",
        "sg-allow-mysql-from-internet",
        "sg-allow-postgresql-from-internet",
        "sg-allow-sqlserver-from-internet",
        "sg-allow-oracle-from-internet",
        "sg-allow-mongodb-from-internet",
        "sg-allow-telnet-from-internet",
        "sg-allow-risky-ports-from-internet",
        "sg-allow-all-traffic",
        "sg-cifs-with-igw-route",
        "sg-rdp-with-igw-route",
        "s3-global-put-permissions",
        "s3-global-permissions",
        "s3-public-access-block-disabled",
        "s3-global-view-acl",
        "s3-public-via-acl",
        "s3-no-server-side-encryption",
        "s3-no-secure-transport-policy",
        "rds-cluster-encryption-disabled",
        "rds-instance-publicly-accessible",
        "rds-snapshot-public",
        "iam-expired-ssl-certificates",
        "iam-user-console-and-keys",
        "iam-access-keys-not-rotated",
        "cloudfront-insecure-ssl-protocols",
        "cloudfront-logging-not-central",
        "cloudfront-tls-v11-or-lower",
        "ecr-repository-public",
        "eks-cluster-public-access",
        "eks-control-plane-logging-disabled",
        "elasticache-redis-no-encryption-at-rest",
        "elasticache-redis-no-transit-encryption-replication",
        "elasticache-redis-no-transit-encryption-standalone",
        "efs-encryption-disabled",
        "elasticsearch-encryption-disabled",
        "kinesis-stream-not-encrypted",
        "redshift-cluster-not-encrypted",
        "redshift-logging-not-central",
        "sns-topic-no-encryption",
        "waf-classic-logging-not-central"
      ],
      "event_mapping": {
        "GuardDuty Finding": [
          {
            "policy_name": "guardduty-findings-auto-archive",
            "resource": "aws.guardduty-finding",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "auto-remediate",
            "description": "Central Account: Notify on high-severity GuardDuty threats"
          }
        ]
      },
      "iam_role": "arn:aws:iam::172327596604:role/CloudCustodian-CrossAccount-ExecutionRole",
      "external_id": "cloud-custodian-172327596604"
    },
    "813185901390": {
      "name": "Cloud Custodian Test Member",
      "environment": "test",
      "description": "Member test account for validating cross-account Cloud Custodian execution",
      "periodic_policies": [
        "alb-http-no-redirect-to-https",
        "alb-outdated-ssl-policy",
        "elb-logging-not-central-bucket",
        "elbv2-no-tls-listener",
        "nlb-outdated-ssl-policy",
        "ami-publicly-accessible",
        "ebs-snapshot-unencrypted",
        "ebs-snapshot-public",
        "ec2-unencrypted-ebs-volume",
        "ec2-instance-older-than-30-days",
        "ec2-imdsv1-enabled",
        "sg-allow-ssh-from-internet",
        "sg-allow-rdp-from-internet",
        "sg-allow-cifs-from-internet",
        "sg-allow-mysql-from-internet",
        "sg-allow-postgresql-from-internet",
        "sg-allow-sqlserver-from-internet",
        "sg-allow-oracle-from-internet",
        "sg-allow-mongodb-from-internet",
        "sg-allow-telnet-from-internet",
        "sg-allow-risky-ports-from-internet",
        "sg-allow-all-traffic",
        "sg-cifs-with-igw-route",
        "sg-rdp-with-igw-route",
        "s3-global-put-permissions",
        "s3-global-permissions",
        "s3-public-access-block-disabled",
        "s3-global-view-acl",
        "s3-public-via-acl",
        "s3-no-server-side-encryption",
        "s3-no-secure-transport-policy",
        "rds-cluster-encryption-disabled",
        "rds-instance-publicly-accessible",
        "rds-snapshot-public",
        "iam-expired-ssl-certificates",
        "iam-user-console-and-keys",
        "iam-access-keys-not-rotated",
        "cloudfront-insecure-ssl-protocols",
        "cloudfront-logging-not-central",
        "cloudfront-tls-v11-or-lower",
        "ecr-repository-public",
        "eks-cluster-public-access",
        "eks-control-plane-logging-disabled",
        "elasticache-redis-no-encryption-at-rest",
        "elasticache-redis-no-transit-encryption-replication",
        "elasticache-redis-no-transit-encryption-standalone",
        "efs-encryption-disabled",
        "elasticsearch-encryption-disabled",
        "kinesis-stream-not-encrypted",
        "redshift-cluster-not-encrypted",
        "redshift-logging-not-central",
        "sns-topic-no-encryption",
        "waf-classic-logging-not-central"
      ],
      "event_mapping": {
        "GuardDuty Finding": [
          {
            "policy_name": "guardduty-findings-auto-archive",
            "resource": "aws.guardduty-finding",
            "source_file": "aws-guardduty-findings-remediate.yml",
            "enforcement_level": "notify",
            "description": "Test Account: Notify on high-severity GuardDuty threats"
          }
        ]
      },
      "iam_role": "arn:aws:iam::813185901390:role/CloudCustodianExecutionRole",
      "external_id": "cloud-custodian-813185901390",
      "notes": "Test member account for cross-account Cloud Custodian validation and testing"
    }
  },
  "policies": {
    "alb-http-no-redirect-to-https": {
      "resource": "aws.app-elb",
      "source_file": "aws-alb-security.yml",
      "mode_type": "periodic",
      "description": "Detect ALBs listening on port 80 without redirect to HTTPS",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "alb-outdated-ssl-policy": {
      "resource": "aws.app-elb",
      "source_file": "aws-alb-security.yml",
      "mode_type": "periodic",
      "description": "Detect ALBs not using latest predefined security policy",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "elb-logging-not-central-bucket": {
      "resource": "aws.elb",
      "source_file": "aws-alb-security.yml",
      "mode_type": "periodic",
      "description": "Detect Classic ELBs with logging not to central bucket",
      "severity": "low",
      "compliance_frameworks": ["CIS"]
    },
    "elbv2-no-tls-listener": {
      "resource": "aws.app-elb",
      "source_file": "aws-alb-security.yml",
      "mode_type": "periodic",
      "description": "Detect ELBv2 without TLS listener configured",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "nlb-outdated-ssl-policy": {
      "resource": "aws.app-elb",
      "source_file": "aws-alb-security.yml",
      "mode_type": "periodic",
      "description": "Detect NLBs not using latest predefined security policy",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "ami-publicly-accessible": {
      "resource": "aws.ami",
      "source_file": "aws-ec2-security.yml",
      "mode_type": "periodic",
      "description": "Detect AMIs that are publicly accessible",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "ebs-snapshot-unencrypted": {
      "resource": "aws.ebs-snapshot",
      "source_file": "aws-ec2-security.yml",
      "mode_type": "periodic",
      "description": "Detect EBS snapshots that are not encrypted",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "ebs-snapshot-public": {
      "resource": "aws.ebs-snapshot",
      "source_file": "aws-ec2-security.yml",
      "mode_type": "periodic",
      "description": "Detect EBS snapshots publicly accessible",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "ec2-unencrypted-ebs-volume": {
      "resource": "aws.ec2",
      "source_file": "aws-ec2-security.yml",
      "mode_type": "periodic",
      "description": "Detect EC2 instances with unencrypted EBS volumes",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "ec2-instance-older-than-30-days": {
      "resource": "aws.ec2",
      "source_file": "aws-ec2-security.yml",
      "mode_type": "periodic",
      "description": "Detect EC2 instances older than 30 days",
      "severity": "low",
      "compliance_frameworks": ["CIS"]
    },
    "ec2-imdsv1-enabled": {
      "resource": "aws.ec2",
      "source_file": "aws-ec2-security.yml",
      "mode_type": "periodic",
      "description": "Detect EC2 instances with IMDSv1 enabled",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security"]
    },
    "sg-allow-ssh-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing SSH from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "sg-allow-rdp-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing RDP from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "sg-allow-cifs-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing CIFS from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-mysql-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing MySQL from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-postgresql-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing PostgreSQL from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-sqlserver-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing SQL Server from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-oracle-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing Oracle DB from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-mongodb-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing MongoDB from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-telnet-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing Telnet from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-risky-ports-from-internet": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing risky ports from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-allow-all-traffic": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect Security Groups allowing all traffic from internet",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "sg-cifs-with-igw-route": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect CIFS port exposed via Internet Gateway",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "sg-rdp-with-igw-route": {
      "resource": "aws.security-group",
      "source_file": "aws-security-groups.yml",
      "mode_type": "periodic",
      "description": "Detect RDP port exposed via Internet Gateway",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "s3-global-put-permissions": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets with global PUT permissions",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "s3-global-permissions": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets with global GET/LIST permissions",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "s3-public-access-block-disabled": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets with public access block disabled",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "s3-global-view-acl": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets with global view ACL permissions",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "s3-public-via-acl": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets publicly accessible via ACL",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "s3-no-server-side-encryption": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets without server-side encryption",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "s3-no-secure-transport-policy": {
      "resource": "aws.s3",
      "source_file": "aws-s3-security.yml",
      "mode_type": "periodic",
      "description": "Detect S3 buckets without secure transport policy",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "rds-cluster-encryption-disabled": {
      "resource": "aws.rds-cluster",
      "source_file": "aws-rds-security.yml",
      "mode_type": "periodic",
      "description": "Detect RDS clusters without encryption at rest",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "rds-instance-publicly-accessible": {
      "resource": "aws.rds",
      "source_file": "aws-rds-security.yml",
      "mode_type": "periodic",
      "description": "Detect RDS instances that are publicly accessible",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "rds-snapshot-public": {
      "resource": "aws.rds-snapshot",
      "source_file": "aws-rds-security.yml",
      "mode_type": "periodic",
      "description": "Detect RDS snapshots publicly accessible",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "iam-expired-ssl-certificates": {
      "resource": "aws.iam-certificate",
      "source_file": "aws-iam-security.yml",
      "mode_type": "periodic",
      "description": "Detect IAM SSL/TLS certificates that have expired",
      "severity": "medium",
      "compliance_frameworks": ["CIS"]
    },
    "iam-user-console-and-keys": {
      "resource": "aws.iam-user",
      "source_file": "aws-iam-security.yml",
      "mode_type": "periodic",
      "description": "Detect IAM users with both console and access keys",
      "severity": "low",
      "compliance_frameworks": ["CIS"]
    },
    "iam-access-keys-not-rotated": {
      "resource": "aws.iam-user",
      "source_file": "aws-iam-security.yml",
      "mode_type": "periodic",
      "description": "Detect IAM access keys not rotated for 365 days",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "cloudfront-insecure-ssl-protocols": {
      "resource": "aws.distribution",
      "source_file": "aws-cloudfront-security.yml",
      "mode_type": "periodic",
      "description": "Detect CloudFront using insecure SSL/TLS protocols",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "cloudfront-logging-not-central": {
      "resource": "aws.distribution",
      "source_file": "aws-cloudfront-security.yml",
      "mode_type": "periodic",
      "description": "Detect CloudFront logging not to central bucket",
      "severity": "low",
      "compliance_frameworks": ["CIS"]
    },
    "cloudfront-tls-v11-or-lower": {
      "resource": "aws.distribution",
      "source_file": "aws-cloudfront-security.yml",
      "mode_type": "periodic",
      "description": "Detect CloudFront with TLS version 1.1 or lower",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "ecr-repository-public": {
      "resource": "aws.ecr",
      "source_file": "aws-container-security.yml",
      "mode_type": "periodic",
      "description": "Detect ECR repositories exposed to public",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "eks-cluster-public-access": {
      "resource": "aws.eks",
      "source_file": "aws-container-security.yml",
      "mode_type": "periodic",
      "description": "Detect EKS clusters with public endpoint access",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "eks-control-plane-logging-disabled": {
      "resource": "aws.eks",
      "source_file": "aws-container-security.yml",
      "mode_type": "periodic",
      "description": "Detect EKS clusters with control plane logging disabled",
      "severity": "medium",
      "compliance_frameworks": ["CIS"]
    },
    "elasticache-redis-no-encryption-at-rest": {
      "resource": "aws.cache-cluster",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect ElastiCache Redis without encryption at rest",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "elasticache-redis-no-transit-encryption-replication": {
      "resource": "aws.cache-cluster",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect ElastiCache Redis replication groups without in-transit encryption",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "elasticache-redis-no-transit-encryption-standalone": {
      "resource": "aws.cache-cluster",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect standalone ElastiCache Redis without in-transit encryption",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "efs-encryption-disabled": {
      "resource": "aws.efs",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect EFS without encryption at rest",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "elasticsearch-encryption-disabled": {
      "resource": "aws.elasticsearch",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect Elasticsearch domains without encryption at rest",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "kinesis-stream-not-encrypted": {
      "resource": "aws.kinesis",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect Kinesis streams without server-side encryption",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "redshift-cluster-not-encrypted": {
      "resource": "aws.redshift",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect Redshift clusters without encryption",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "redshift-logging-not-central": {
      "resource": "aws.redshift",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect Redshift audit logging not to central bucket",
      "severity": "low",
      "compliance_frameworks": ["CIS"]
    },
    "sns-topic-no-encryption": {
      "resource": "aws.sns",
      "source_file": "aws-data-encryption.yml",
      "mode_type": "periodic",
      "description": "Detect SNS topics without server-side encryption",
      "severity": "medium",
      "compliance_frameworks": ["CIS", "PCI-DSS"]
    },
    "waf-classic-logging-not-central": {
      "resource": "aws.waf",
      "source_file": "aws-waf-security.yml",
      "mode_type": "periodic",
      "description": "Detect WAF Classic logging not to central stream",
      "severity": "low",
      "compliance_frameworks": ["CIS"]
    },
    "s3-public-bucket-remediation-realtime": {
      "resource": "aws.s3",
      "source_file": "s3-public-bucket-remediation-realtime.yml",
      "mode_type": "cloudtrail",
      "description": "Monitor S3 buckets in real-time and automatically secure public buckets",
      "severity": "critical",
      "compliance_frameworks": ["CIS", "PCI-DSS", "HIPAA"]
    },
    "security-hub-findings-notification": {
      "resource": "aws.security-hub-finding",
      "source_file": "security-hub-findings-notification.yml",
      "mode_type": "cloudtrail",
      "description": "Monitor Security Hub findings in real-time and notify on HIGH and CRITICAL severity findings",
      "severity": "variable",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security"]
    },
    "guardduty-findings-auto-archive": {
      "resource": "aws.guardduty-finding",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "event-driven",
      "description": "Send notifications for high-severity GuardDuty findings",
      "severity": "high-critical",
      "compliance_frameworks": ["CIS", "AWS-Foundational-Security", "PCI-DSS", "HIPAA"]
    }
  },
  "enforcement_levels": {
    "strict": "Immediate automated remediation without notification delay",
    "auto-remediate": "Automated remediation with notification",
    "moderate": "Partial remediation with manual review options",
    "notify": "Notification only, manual remediation required",
    "notify-only": "Notification without any automated action"
  },
  "metadata": {
    "version": "3.0.0",
    "last_updated": "2025-11-30T00:00:00Z",
    "author": "Cloud Custodian Team",
    "description": "Comprehensive multi-account policy mapping with 54 security policies covering ALB, EC2, Security Groups, S3, RDS, IAM, CloudFront, EKS, ECR, ElastiCache, EFS, Elasticsearch, Kinesis, Redshift, SNS, and WAF",
    "central_account_id": "172327596604",
    "member_account_ids": ["813185901390"],
    "policy_categories": [
      "Load Balancer Security",
      "Compute Security", 
      "Network Security",
      "Storage Security",
      "Database Security",
      "Identity & Access Management",
      "Content Delivery",
      "Container Security",
      "Data Encryption",
      "Web Application Firewall"
    ]
  }
}
