policies:
  - name: ec2-require-tags
    resource: ec2
    description: Terminate EC2 instances without required tags after 1 hour grace period
    mode:
      type: cloudtrail
      events:
        - RunInstances
      role: arn:aws:iam::{account_id}:role/CloudCustodianExecutionRole
    filters:
      - or:
          - tag:Owner: absent
          - tag:Environment: absent
          - tag:CostCenter: absent
      - type: instance-age
        op: greater-than
        hours: 1
    actions:
      - type: mark-for-op
        op: terminate
        days: 1
        tag: custodian_cleanup
      - type: terminate
        force: true
