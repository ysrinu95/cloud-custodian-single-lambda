policies:
  - name: s3-block-public-access
    resource: s3
    description: Enable block public access settings on all S3 buckets
    mode:
      type: cloudtrail
      events:
        - CreateBucket
      role: arn:aws:iam::{account_id}:role/CloudCustodianExecutionRole
    filters:
      - or:
          - type: bucket-public-access-block
            key: BlockPublicAcls
            value: false
          - type: bucket-public-access-block
            key: BlockPublicPolicy
            value: false
          - type: bucket-public-access-block
            key: IgnorePublicAcls
            value: false
          - type: bucket-public-access-block
            key: RestrictPublicBuckets
            value: false
    actions:
      - type: set-public-access-block
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
