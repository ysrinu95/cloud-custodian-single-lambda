{
  "version": "1.0",
  "description": "Cloud Custodian Policy Event Mapping",
  "generated_at": "auto-generated",
  "statistics": {
    "total_policies": 8,
    "event_driven_policies": 8,
    "unique_events": 4
  },
  "event_mapping": {
    "RunInstances": [
      {
        "policy_name": "aws-ec2-stop-public-instances",
        "resource": "aws.ec2",
        "source_file": "aws-ec2-stop-public-instances.yml"
      }
    ],
    "CreateBucket": [
      {
        "policy_name": "s3-public-bucket-remediation-realtime",
        "resource": "aws.s3",
        "source_file": "s3-public-bucket-remediation-realtime.yml"
      }
    ],
    "Security Hub Findings - Imported": [
      {
        "policy_name": "security-hub-findings-notification",
        "resource": "aws.security-hub-finding",
        "source_file": "security-hub-findings-notification.yml"
      },
      {
        "policy_name": "securityhub-failed-findings-remediation",
        "resource": "aws.security-hub-finding",
        "source_file": "aws-securityhub-auto-remediate.yml"
      }
    ],
    "GuardDuty Finding": [
      {
        "policy_name": "guardduty-findings-remediation",
        "resource": "aws.guardduty-finding",
        "source_file": "aws-guardduty-findings-remediate.yml"
      },
      {
        "policy_name": "guardduty-backdoor-ec2-isolation",
        "resource": "ec2",
        "source_file": "aws-guardduty-findings-remediate.yml"
      },
      {
        "policy_name": "guardduty-cryptocurrency-ec2-termination",
        "resource": "ec2",
        "source_file": "aws-guardduty-findings-remediate.yml"
      },
      {
        "policy_name": "guardduty-unauthorized-iam-remediation",
        "resource": "iam-user",
        "source_file": "aws-guardduty-findings-remediate.yml"
      }
    ]
  },
  "policies": {
    "aws-ec2-stop-public-instances": {
      "resource": "aws.ec2",
      "source_file": "aws-ec2-stop-public-instances.yml",
      "mode_type": "cloudtrail",
      "description": "Notifies of and stops EC2 instances launched in a public subnet\n"
    },
    "s3-public-bucket-remediation-realtime": {
      "resource": "aws.s3",
      "source_file": "s3-public-bucket-remediation-realtime.yml",
      "mode_type": "cloudtrail",
      "description": "Monitor S3 buckets in real-time and automatically secure public buckets.\nTriggers when S3 buckets are created or modified.\n"
    },
    "security-hub-findings-notification": {
      "resource": "aws.security-hub-finding",
      "source_file": "security-hub-findings-notification.yml",
      "mode_type": "cloudtrail",
      "description": "Monitor Security Hub findings in real-time and notify on HIGH and CRITICAL severity findings.\nTriggers when Security Hub imports new findings.\n"
    },
    "securityhub-failed-findings-remediation": {
      "resource": "aws.security-hub-finding",
      "source_file": "aws-securityhub-auto-remediate.yml",
      "mode_type": "cloudtrail",
      "description": "Automatically remediate SecurityHub failed findings by updating their workflow status and adding remediation notes.\n"
    },
    "guardduty-findings-remediation": {
      "resource": "aws.guardduty-finding",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "guardduty",
      "description": "Auto-remediate GuardDuty threat findings in real-time for instant response to security threats."
    },
    "guardduty-backdoor-ec2-isolation": {
      "resource": "ec2",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "guardduty",
      "description": "Isolate EC2 instances involved in backdoor/C&C communication detected by GuardDuty."
    },
    "guardduty-cryptocurrency-ec2-termination": {
      "resource": "ec2",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "guardduty",
      "description": "Terminate EC2 instances involved in cryptocurrency mining detected by GuardDuty."
    },
    "guardduty-unauthorized-iam-remediation": {
      "resource": "iam-user",
      "source_file": "aws-guardduty-findings-remediate.yml",
      "mode_type": "guardduty",
      "description": "Disable IAM users and access keys involved in unauthorized access detected by GuardDuty."
    }
  }
}
