{
   "attachments":[
      {
         "fallback":"Cloud Custodian Policy Violation",
         "title":"AWS Policy Alert",
         "color":"{{ action['slack_msg_color']|default("danger") }}",
         "fields":[
            {
               "title":"Violation Description",
               "value":"{{ action['violation_desc'] }}"
            },
            {
               "title":"Resources",
               "value":"{%- for resource in resources -%}
                        {{ resource['UserName'] }} | UserId={{ resource['UserId'] }} \n
                        {%- endfor -%}"
            },
            {
               "title":"Account",
               "value":"{{ account }}"
            },
            {
               "title":"Action",
               "value":"{{ action['action_desc'] }}"
            }
         ]
      }
   ],
   {%- if not recipient.startswith('https://') %}
   "channel":"{{ recipient }}",
   {%- endif -%}
   "username":"Cloud Custodian"
}
