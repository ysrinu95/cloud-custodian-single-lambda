policies:
- name: security-group-ssh-remediation-realtime
  resource: aws.security-group
  description: Monitor security groups in real-time and remove unrestricted SSH access.
    Triggers when security group rules are modified.
  filters:
  - type: ingress
    Ports:
    - 22
    Cidr: 0.0.0.0/0
  actions:
  - type: remove-permissions
    ingress: matched
  - type: notify
    template: aws-basic_email.html
    priority_header: '3'
    subject: Security Group SSH Access Restricted - {{ account }} {{ region }}
    to:
    - resource-owner
    transport:
      type: sns
      topic: arn:aws:sns:{region}:{account_id}:cloud-custodian-notifications
