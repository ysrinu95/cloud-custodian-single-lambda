policies:
- name: config-compliance-violations
  resource: aws.config-rule
  description: Respond to AWS Config rule compliance violations in real-time. This
    policy triggers when resources become non-compliant with Config rules.
  filters:
  - type: value
    key: compliance.ComplianceType
    value: NON_COMPLIANT
  - type: value
    key: ConfigRuleName
    op: in
    value:
    - encrypted-volumes
    - s3-bucket-public-read-prohibited
    - s3-bucket-public-write-prohibited
    - iam-password-policy
    - root-account-mfa-enabled
    - restricted-ssh
    - restricted-common-ports
  actions:
  - type: invoke-lambda
    function: custodian-config-compliance-tagger
    async: true
  - type: notify
    template: aws-basic_email.html
    priority_header: '2'
    violation_desc: AWS Config Rule Compliance Violation
    action_desc: 'A resource has become non-compliant with AWS Config rules.

      Review and remediate the compliance violation.

      '
    to:
    - compliance-team@optum.com
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
