policies:
- name: aws-rds-stop-public-db-instances
  resource: aws.rds
  description: 'Notifies of and stops RDS DB instances launched as publicly accessible'
  filters:
  - type: value
    key: PubliclyAccessible
    value: true
  actions:
  - type: stop
  - template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
    type: notify
    priority_header: 1
    subject: '[c7n] [{{ account }}] Public RDS DB Instances Launched ({{ region }})'
    violation_desc: RDS DB instance launched with public access
    action_desc: 'Actions taken: The violating RDS DB instance has been stopped. <br>

      No RDS DB Instances should be exposed to public. <br>

      '
vars:
  tags:
    contact: ysrinu95@gmail.com
    environment: production
    repo: ysrinu95/cloud-custodian
  email-notify:
    template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
