policies:
- name: aws-ec2-stop-public-instances
  resource: aws.ec2
  description: 'Notifies of and stops EC2 instances launched in a public subnet'
  filters: []
  actions:
  - type: stop
    force: true
  - template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue-dev
    type: notify
    priority_header: 1
    subject: '[c7n] [{{ account }}] Public EC2 Instance Launched ({{ region }})'
    violation_desc: EC2 instance launched in a public subnet
    action_desc: "Actions taken: The violating EC2 instance has been stopped. <br>\n\
      To expose an application or service publicly, a load balancer should be placed\n\
      in a public subnet which routes the traffic internally. <br>          \n<a href=\"\
      https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#ec2-9-remediation\"\
      >Documentation</a> \n"
vars:
  tags:
    contact: ysrinu95@gmail.com
    environment: production
    repo: ysrinu95/cloud-custodian
  email-notify:
    template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
