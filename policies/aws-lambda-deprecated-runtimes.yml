policies:
- name: aws-lambda-deprecated-runtimes
  resource: aws.lambda
  description: 'Notifies of Lambda functions using deprecated runtimes'
  filters:
  - type: value
    key: Runtime
    value:
    - nodejs
    - dotnetcore2.0
    - dotnetcore1.0
    - nodejs6.10
    - nodejs4.3-edge
    - nodejs4.3
    - nodejs8.10
    - python2.7
    - ruby2.5
    - nodejs10.x
    - dotnetcore2.1
    - dotnet5.0
    - python3.6
    - nodejs12.x
    - dotnetcore3.1
    - python3.7
    - nodejs14.x
    - ruby2.7
    - provided
    - go1.x
    - java8
    - dotnet6
    - dotnet7
    - nodejs16.x
    - python3.8
    op: in
  - not:
    - type: value
      key: FunctionName
      op: regex
      value: (aws-controltower)-\w+
      value_type: normalize
  actions:
  - template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
    type: notify
    subject: '[c7n] [{{ account }}] Lambda Functions Using Deprecated Runtimes Report
      ({{ region }})'
    violation_desc: Lambda functions configured to use a deprecated runtime
    action_desc: 'No action taken. Functions MUST be updated to the latest runtime.<br>

      These functions can no longer be updated and are not receiving security patches.<br>

      <a href="https://docs.aws.amazon.com/lambda/latest/dg/lambda-runtimes.html">Documentation</a>

      '
vars:
  tags:
    contact: ysrinu95@gmail.com
    environment: production
    repo: ysrinu95/cloud-custodian
  email-notify:
    template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
