policies:
- name: aws-elb-outdated-tls-protocols
  resource: app-elb
  description: 'Notifies on usage of outdated TLS protocols'
  filters:
  - type: listener
    key: Protocol
    value: HTTPS
  - type: listener
    key: SslPolicy
    value:
    - ELBSecurityPolicy-TLS-1-1-2017-01
    - ELBSecurityPolicy-TLS13-1-1-2021-06
    - ELBSecurityPolicy-TLS13-1-0-2021-06
    - ELBSecurityPolicy-2016-08
    - ELBSecurityPolicy-2015-05
    op: in
  actions:
  - template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
    type: notify
    priority_header: 1
    subject: '[c7n] [{{ account }}] Outdated ALB TLS protocols found ({{ region }})'
    violation_desc: Outdated TLS Protocol is configured on ALB
    action_desc: "An outdated SSL TLS policy is configured on the ALB. Please update\
      \ to a newer policy that does not support TLS 1.2 or 1.3. <br>          \n<a\
      \ href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/describe-ssl-policies.html#tls-protocols\"\
      >Documentation</a>\n"
vars:
  tags:
    contact: ysrinu95@gmail.com
    environment: production
    repo: ysrinu95/cloud-custodian
  email-notify:
    template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
