policies:
- name: aws-iam-unused-roles-report
  resource: aws.iam-role
  description: 'Notifies of IAM roles found to be unused'
  filters:
  - type: usage
    match-operator: all
    LastAuthenticated: null
  - type: value
    key: CreateDate
    op: gt
    value: 365
    value_type: age
  - tag:c7n-exception:unused: absent
  actions:
  - template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
    type: notify
    subject: '[c7n] [{{ account }}] IAM Roles Are Unused'
    violation_desc: IAM Roles that appear to be unused
    action_desc: 'No action taken.<br>

      As a best practice, delete roles that are no longer in use.<br>

      '
vars:
  tags:
    contact: ysrinu95@gmail.com
    environment: production
    repo: ysrinu95/cloud-custodian
  email-notify:
    template: aws-basic_email.html
    to:
    - ysrinu95@gmail.com
    - event-owner
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
