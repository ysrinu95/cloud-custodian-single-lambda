policies:
- name: s3-public-bucket-remediation-realtime
  resource: aws.s3
  description: Monitor S3 buckets in real-time and automatically secure public buckets.
    Triggers when S3 buckets are created or modified.
  filters:
  - type: check-public-block
    BlockPublicAcls: false
  actions:
  - type: set-public-block
    BlockPublicAcls: true
    BlockPublicPolicy: true
    IgnorePublicAcls: true
    RestrictPublicBuckets: true
  - type: notify
    template: aws-basic_email.html
    priority_header: '2'
    subject: '[c7n] [{{ account }}] S3 Bucket Secured - Public Access Blocked ({{ region }})'
    to:
    - ysrinu95@gmail.com
    - resource-owner
    transport:
      type: sqs
      queue: https://sqs.us-east-1.amazonaws.com/172327596604/custodian-mailer-queue
    violation_desc: 'S3 bucket had public access enabled'
    action_desc: 'Actions taken: Public access block has been enabled on the bucket. All public ACLs and policies are now blocked.'
