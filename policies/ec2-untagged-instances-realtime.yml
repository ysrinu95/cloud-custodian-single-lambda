policies:
- name: ec2-untagged-instances-realtime
  resource: aws.ec2
  description: 'Auto-tags EC2 instances missing required tags. Triggers on EC2 instance launch events.'
  filters:
  - tag:Name: absent
  - tag:Environment: absent
  actions:
  - type: tag
    key: AutoTagged
    value: 'true'
  - type: tag
    key: Environment
    value: unspecified
  - type: notify
    template: default
    priority_header: '1'
    subject: EC2 Instance Auto-Tagged - {{ account }} {{ region }}
    to:
    - resource-owner
    transport:
      type: sns
      topic: arn:aws:sns:{region}:{account_id}:cloud-custodian-notifications
