<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.0.9 Chrome/128.0.6613.186 Electron/32.2.5 Safari/537.36" version="26.0.9" pages="5">
  <diagram id="j94FJMx5qvuLL_ak9weA" name="Cloud Custodian - Unified Event-Driven Architecture">
    <mxGraphModel dx="1242" dy="911" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="_PE6ApAasZ940RLW87RD-2" value="AWS Cloud" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#d6b656;verticalAlign=top;fontSize=13;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="110" width="1240" height="970" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-1" value="Cloud Custodian - Unified Event-Driven Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="350" y="30" width="700" height="40" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-3" value="Event Sources" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="160" width="200" height="30" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-4" value="CloudTrail" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#759C3E;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.cloudtrail;" vertex="1" parent="1">
          <mxGeometry x="140" y="190" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-5" value="Security Hub" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.security_hub;" vertex="1" parent="1">
          <mxGeometry x="140" y="280" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-6" value="GuardDuty" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.guardduty;" vertex="1" parent="1">
          <mxGeometry x="140" y="370" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-7" value="Config" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#759C3E;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.config;" vertex="1" parent="1">
          <mxGeometry x="140" y="460" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-8" value="Macie" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.macie;" vertex="1" parent="1">
          <mxGeometry x="140" y="550" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-9" value="EventBridge&#xa;(Unified Rule)&#xa;&#xa;Single event pattern&#xa;matching all sources" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.eventbridge;" vertex="1" parent="1">
          <mxGeometry x="360" y="340" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-10" value="Lambda Invoker&#xa;&#xa;• Load policy_map.json&#xa;• Match event to policy&#xa;• Upload large events to S3&#xa;• Enqueue to SQS" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.lambda_function;" vertex="1" parent="1">
          <mxGeometry x="560" y="340" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-11" value="SQS Queue&#xa;&#xa;Buffer &amp;amp; DLQ&#xa;(rate limiting)" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.sqs;" vertex="1" parent="1">
          <mxGeometry x="760" y="340" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-12" value="ECS Fargate Worker&#xa;&#xa;• Poll SQS&#xa;• Fetch policy_map.json from S3&#xa;• Fetch policies from S3&#xa;• Fetch event (S3 if large)&#xa;• Run custodian&#xa;• Upload outputs&#xa;• Delete message" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.ecs_service;" vertex="1" parent="1">
          <mxGeometry x="960" y="340" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-13" value="S3 Bucket&#xa;&#xa;• policy_map.json&#xa;• Policies (*.yml)&#xa;• Large events&#xa;• Execution outputs" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.bucket;" vertex="1" parent="1">
          <mxGeometry x="960" y="662" width="75" height="78" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-14" value="CloudWatch Logs" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#759C3E;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=13;aspect=fixed;shape=mxgraph.aws4.cloudwatch;" vertex="1" parent="1">
          <mxGeometry x="1160" y="340" width="78" height="78" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-15" value="CI/CD Pipeline" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;verticalAlign=top;fontSize=13;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="480" y="150" width="720" height="120" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-16" value="1. Generate policy_map.json from policies (scan meta.triggers)&#xa;2. Build &amp;amp; push Docker image to ECR (lightweight, no policies)&#xa;3. Update ECS task definition&#xa;4. Publish policy_map.json and policies (*.yml) to S3" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="500" y="180" width="680" height="70" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-4" target="_PE6ApAasZ940RLW87RD-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="220" />
              <mxPoint x="280" y="379" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-5" target="_PE6ApAasZ940RLW87RD-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="310" />
              <mxPoint x="280" y="379" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-6" target="_PE6ApAasZ940RLW87RD-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="400" />
              <mxPoint x="280" y="379" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-7" target="_PE6ApAasZ940RLW87RD-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="490" />
              <mxPoint x="280" y="379" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-21" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-8" target="_PE6ApAasZ940RLW87RD-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="580" />
              <mxPoint x="280" y="379" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E7157B;strokeWidth=3;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-9" target="_PE6ApAasZ940RLW87RD-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-23" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#ED7100;strokeWidth=3;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-10" target="_PE6ApAasZ940RLW87RD-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#E7157B;strokeWidth=3;dashed=1;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-11" target="_PE6ApAasZ940RLW87RD-12">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-25" value="Poll" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;" connectable="0" vertex="1" parent="_PE6ApAasZ940RLW87RD-24">
          <mxGeometry x="-0.1" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-26" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#7AA116;strokeWidth=2;dashed=1;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-12" target="_PE6ApAasZ940RLW87RD-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-27" value="Fetch config&#xa;policies, events&#xa;Write outputs" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;" connectable="0" vertex="1" parent="_PE6ApAasZ940RLW87RD-26">
          <mxGeometry x="-0.1" y="1" relative="1" as="geometry">
            <mxPoint x="-1" y="89" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#759C3E;strokeWidth=2;dashed=1;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-12" target="_PE6ApAasZ940RLW87RD-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-29" value="Logs" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;" vertex="1" connectable="0" parent="_PE6ApAasZ940RLW87RD-28">
          <mxGeometry x="-0.1" y="1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-30" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#7AA116;strokeWidth=1;dashed=1;fontSize=13;" edge="1" parent="1" source="_PE6ApAasZ940RLW87RD-10" target="_PE6ApAasZ940RLW87RD-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="599" y="701" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-31" value="Large events" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=13;" vertex="1" connectable="0" parent="_PE6ApAasZ940RLW87RD-30">
          <mxGeometry x="-0.1" y="1" relative="1" as="geometry">
            <mxPoint x="-7" y="-90" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-32" value="Key Benefits" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;fontSize=13;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="130" y="865" width="560" height="120" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-33" value="✓ Single EventBridge rule (not 50+ rules)&#xa;✓ Single Lambda invoker (policy mapping logic centralized)&#xa;✓ SQS buffering (rate limiting, DLQ, retry semantics)&#xa;✓ Scalable Fargate workers (autoscale based on queue depth)&#xa;✓ Dynamic policy loading from S3 (no image rebuild for policy changes)&#xa;✓ Cost-effective (batching, pay-per-use)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="150" y="895" width="520" height="80" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-34" value="Event Flow" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;verticalAlign=top;fontSize=13;fontStyle=1;align=center;" vertex="1" parent="1">
          <mxGeometry x="740" y="848" width="560" height="150" as="geometry" />
        </mxCell>
        <mxCell id="_PE6ApAasZ940RLW87RD-35" value="1. Event emitted → EventBridge (union pattern matches all sources)&#xa;2. EventBridge → Lambda Invoker (parse, map to policy, enqueue)&#xa;3. Lambda → SQS (buffered message with policy id + event payload)&#xa;4. Fargate Worker polls SQS → fetch policy_map.json from S3 → fetch matching policy from S3 → fetch event (S3 if large) → run custodian&#xa;5. Custodian executes policy → actions taken → outputs to S3&#xa;6. Worker deletes SQS message on success (or moves to DLQ on failure)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;" vertex="1" parent="1">
          <mxGeometry x="770" y="886" width="520" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram name="Event-Driven Policy Deployment/Execution" id="single-account">
    <mxGraphModel dx="2882" dy="911" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="Cloud Custodian Event-Driven AWS Deployment - Single Account" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="180" y="10" width="1000" height="40" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-2" target="B4SwCHD0Qk1NhdxizYkp-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-2" target="B4SwCHD0Qk1NhdxizYkp-13" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="914.0999999999999" y="460" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-2" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.lambda_function;" parent="1" vertex="1">
          <mxGeometry x="890" y="320" width="48" height="48" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-3" target="B4SwCHD0Qk1NhdxizYkp-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-3" value="" style="points=[];aspect=fixed;html=1;align=center;shadow=0;dashed=0;fillColor=#FF6A00;strokeColor=none;shape=mxgraph.alibaba_cloud.eventbridge;" parent="1" vertex="1">
          <mxGeometry x="669" y="320" width="48.9" height="48.9" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-5" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#E7157B;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.cloudwatch_logs;" parent="1" vertex="1">
          <mxGeometry x="887.11" y="170" width="53.79" height="40" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-7" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.sqs;" parent="1" vertex="1">
          <mxGeometry x="1076" y="460.5" width="69.5" height="69.5" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-12" value="" style="endArrow=classic;html=1;rounded=0;entryX=0;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;dashed=1;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-2" target="B4SwCHD0Qk1NhdxizYkp-7" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="490" y="530" as="sourcePoint" />
            <mxPoint x="540" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-13" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.bucket_with_objects;" parent="1" vertex="1">
          <mxGeometry x="881.34" y="451" width="66.35" height="69" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-14" value="Policy Lambda" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="870" y="300" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-15" value="Policy EventBridge&lt;div&gt;Rule with Pattern&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="654.45" y="275" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-16" value="SQS" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1094.75" y="530" width="50" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-17" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.lambda_function;" parent="1" vertex="1">
          <mxGeometry x="1083" y="320" width="48" height="48" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-18" value="CloudWatch Log" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="845" y="130" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-19" value="S3 Bucket" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="874" y="520" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-20" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.simple_email_service;" parent="1" vertex="1">
          <mxGeometry x="1230" y="319" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-24" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-21" target="B4SwCHD0Qk1NhdxizYkp-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-21" value="Emailer Lambda" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="1055" y="368" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-22" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-17" target="B4SwCHD0Qk1NhdxizYkp-20" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-23" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" source="B4SwCHD0Qk1NhdxizYkp-17" target="B4SwCHD0Qk1NhdxizYkp-5" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="990" y="530" as="sourcePoint" />
            <mxPoint x="1040" y="480" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-26" value="AWS Account" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_account;strokeColor=#CD2264;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#CD2264;dashed=0;" parent="1" vertex="1">
          <mxGeometry x="590" y="90" width="800" height="590" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-25" value="Region" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_region;strokeColor=#00A4A6;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;dashed=1;" parent="B4SwCHD0Qk1NhdxizYkp-26" vertex="1">
          <mxGeometry x="60" y="40" width="720" height="495" as="geometry" />
        </mxCell>
        <mxCell id="u4zqIFwzG6ad-M1Vz7Te-6" value="Or" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="B4SwCHD0Qk1NhdxizYkp-25">
          <mxGeometry x="12" y="331" width="170" height="64" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-28" value="2.2" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="B4SwCHD0Qk1NhdxizYkp-25" vertex="1">
          <mxGeometry x="256.34000000000003" y="130" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-29" value="3" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="B4SwCHD0Qk1NhdxizYkp-25" vertex="1">
          <mxGeometry x="261.34000000000003" y="260" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-31" value="4" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="B4SwCHD0Qk1NhdxizYkp-25" vertex="1">
          <mxGeometry x="350" y="280" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-32" value="7" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="B4SwCHD0Qk1NhdxizYkp-25" vertex="1">
          <mxGeometry x="364" y="120" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-33" value="6" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="B4SwCHD0Qk1NhdxizYkp-25" vertex="1">
          <mxGeometry x="520" y="212" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-34" value="5" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="B4SwCHD0Qk1NhdxizYkp-25" vertex="1">
          <mxGeometry x="459" y="280" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="u4zqIFwzG6ad-M1Vz7Te-2" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.lambda_function;" vertex="1" parent="B4SwCHD0Qk1NhdxizYkp-25">
          <mxGeometry x="18" y="337" width="48" height="48" as="geometry" />
        </mxCell>
        <mxCell id="u4zqIFwzG6ad-M1Vz7Te-3" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.step_functions;" vertex="1" parent="B4SwCHD0Qk1NhdxizYkp-25">
          <mxGeometry x="122" y="336" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="u4zqIFwzG6ad-M1Vz7Te-7" value="2.1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="B4SwCHD0Qk1NhdxizYkp-25">
          <mxGeometry x="145" y="260" width="40" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-27" value="1" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="785" y="319" width="30" height="30" as="geometry" />
        </mxCell>
        <mxCell id="B4SwCHD0Qk1NhdxizYkp-38" value="&lt;p style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;p1&quot;&gt;&lt;b&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;0. Resource Creation&lt;/b&gt;&lt;b&gt;&lt;/b&gt;&lt;/p&gt;&lt;ul style=&quot;font-size: medium;&quot; class=&quot;ul1&quot;&gt;&lt;ul style=&quot;list-style-type: disc;&quot; class=&quot;ul1&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;span style=&quot;font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Menlo;&quot; class=&quot;s1&quot;&gt;&lt;/span&gt;For each policy, an Policy EventBridge rule and a corresponding Policy Lambda function are created.&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;ol style=&quot;&quot; class=&quot;ol1&quot;&gt;&lt;li style=&quot;font-size: 13px; margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;b&gt;Event Trigger&lt;/b&gt;&lt;b&gt;&lt;/b&gt;&lt;/li&gt;&lt;ul style=&quot;font-size: medium; list-style-type: disc;&quot; class=&quot;ul1&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;span style=&quot;font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Menlo;&quot; class=&quot;s1&quot;&gt;&lt;/span&gt;When a relevant event occurs, the EventBridge rule triggers its target Lambda.&lt;/li&gt;&lt;/ul&gt;&lt;li style=&quot;font-size: 13px; margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;b&gt;Policy Action &amp;amp; Logging&lt;/b&gt;&lt;b&gt;&lt;/b&gt;&lt;/li&gt;&lt;ul style=&quot;font-size: medium; list-style-type: disc;&quot; class=&quot;ul1&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;span style=&quot;font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Menlo;&quot; class=&quot;s1&quot;&gt;&lt;/span&gt;The Lambda executes the policy actions. Execution logs are stored in a dedicated CloudWatch Log Group.&lt;/li&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;In case of critical/high security incidents, another lambda or step function might be triggered to execute the incident response run-book&lt;/li&gt;&lt;/ul&gt;&lt;li style=&quot;font-size: 13px; margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;b&gt;Policy Output Storage&lt;/b&gt;&lt;b&gt;&lt;/b&gt;&lt;/li&gt;&lt;ul style=&quot;font-size: medium; list-style-type: disc;&quot; class=&quot;ul1&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;span style=&quot;font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Menlo;&quot; class=&quot;s1&quot;&gt;&lt;/span&gt;Policy execution results are saved to an S3 bucket for auditing and analysis.&lt;/li&gt;&lt;/ul&gt;&lt;li style=&quot;font-size: 13px; margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;b&gt;Notification Handling&lt;/b&gt;&lt;b&gt;&lt;/b&gt;&lt;/li&gt;&lt;ul style=&quot;font-size: medium; list-style-type: disc;&quot; class=&quot;ul1&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;span style=&quot;font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Menlo;&quot; class=&quot;s1&quot;&gt;&lt;/span&gt;If the policy action includes notifications, messages are published to an SQS queue.&lt;/li&gt;&lt;/ul&gt;&lt;li style=&quot;font-size: 13px; margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;b&gt;Email Notification&lt;/b&gt;&lt;b&gt;&lt;/b&gt;&lt;/li&gt;&lt;ul style=&quot;font-size: medium; list-style-type: disc;&quot; class=&quot;ul1&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;&lt;span style=&quot;font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 9px; line-height: normal; font-family: Menlo;&quot; class=&quot;s1&quot;&gt;&lt;/span&gt;The Emailer Lambda monitors the SQS queue, applies the appropriate email template&lt;/li&gt;&lt;/ul&gt;&lt;li style=&quot;font-size: medium;&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;Helvetica Neue&amp;quot;; font-size: 13px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Sends notifications via Amazon SES.&lt;/span&gt;&lt;/li&gt;&lt;li style=&quot;font-size: medium;&quot;&gt;&lt;b style=&quot;font-family: &amp;quot;Helvetica Neue&amp;quot;; font-size: 13px; background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Emailer Logging&lt;/b&gt;&lt;br&gt;&lt;/li&gt;&lt;ul style=&quot;font-size: medium;&quot;&gt;&lt;li style=&quot;margin: 0px; font-variant-numeric: normal; font-variant-east-asian: normal; font-variant-alternates: normal; font-size-adjust: none; font-kerning: auto; font-optical-sizing: auto; font-feature-settings: normal; font-variation-settings: normal; font-variant-position: normal; font-stretch: normal; font-size: 13px; line-height: normal; font-family: &amp;quot;Helvetica Neue&amp;quot;;&quot; class=&quot;li1&quot;&gt;All Emailer Lambda execution logs are stored in a separate CloudWatch Log Group.&lt;/li&gt;&lt;/ul&gt;&lt;/ol&gt;" style="text;html=1;whiteSpace=wrap;overflow=hidden;rounded=0;strokeColor=default;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="-80" y="90" width="611.1" height="590" as="geometry" />
        </mxCell>
        <mxCell id="u4zqIFwzG6ad-M1Vz7Te-5" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" target="u4zqIFwzG6ad-M1Vz7Te-6">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="890" y="360" as="sourcePoint" />
            <mxPoint x="838" y="490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="event-driven-activity" name="Event-Driven - Activity Diagram">
    <mxGraphModel dx="1482" dy="911" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="ed-title" value="Cloud Custodian Event-Driven Policy Execution - Activity Diagram" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="20" width="900" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ed-start-node" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="525" y="80" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ed-step1-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-start-node" target="ed-step1-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step1-box" value="0. Resource Deployment&#xa;&#xa;Policy Lambda function and&#xa;EventBridge rule created&#xa;(one-time setup)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="160" width="260" height="90" as="geometry" />
        </mxCell>
        <mxCell id="ed-step2-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step1-box" target="ed-step2-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step2-box" value="1. AWS Event Occurs&#xa;&#xa;Resource creation/modification&#xa;triggers CloudTrail event" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="280" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-step3-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step2-box" target="ed-pattern-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-pattern-decision" value="Event Matches&#xa;EventBridge&#xa;Pattern?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="460" y="390" width="180" height="110" as="geometry" />
        </mxCell>
        <mxCell id="ed-no-match-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-pattern-decision" target="ed-ignored-box" edge="1">
          <mxGeometry x="-0.7" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-ignored-box" value="Event Ignored" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="410" width="160" height="70" as="geometry" />
        </mxCell>
        <mxCell id="ed-return-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#999999;" parent="1" source="ed-ignored-box" target="ed-step2-box" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="980" y="445" />
              <mxPoint x="980" y="320" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-pattern-decision" target="ed-step3-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step3-box" value="2. Lambda Invocation&#xa;&#xa;EventBridge triggers&#xa;Policy Lambda function" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="530" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-step4-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step3-box" target="ed-step4-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step4-box" value="3. Policy Execution&#xa;&#xa;Load policy, query resources,&#xa;apply filters, evaluate matches" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="640" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-step5-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step4-box" target="ed-resources-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-resources-decision" value="Resources&#xa;Match&#xa;Filters?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="750" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="ed-no-resources-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-resources-decision" target="ed-log-only" edge="1">
          <mxGeometry x="-0.6" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-log-only" value="Log Result&#xa;(No actions)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="765" width="160" height="70" as="geometry" />
        </mxCell>
        <mxCell id="ed-log-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-log-only" target="ed-cloudwatch-box" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="840" y="1340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-yes-resources-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-resources-decision" target="ed-step5-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step5-box" value="4. Execute Actions&#xa;&#xa;Perform policy actions&#xa;(terminate, tag, modify, etc.)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="880" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-step6-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step5-box" target="ed-step6-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step6-box" value="5. Store Results&#xa;&#xa;Save execution results to S3&#xa;(audit trail, resource details)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="990" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-step7-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step6-box" target="ed-notify-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-notify-decision" value="Policy Has&#xa;Notifications?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="1100" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="ed-notify-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-notify-decision" target="ed-step7-box" edge="1">
          <mxGeometry x="-0.7143" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-step7-box" value="6. Send Notifications&#xa;&#xa;Publish messages to SQS queue" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="190" y="1110" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-step8-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step7-box" target="ed-step8-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-step8-box" value="7. Email Processing&#xa;&#xa;Emailer Lambda processes SQS,&#xa;sends via SES" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="190" y="1220" width="220" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-notify-no-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-notify-decision" target="ed-cloudwatch-box" edge="1">
          <mxGeometry x="-0.7273" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-cloudwatch-box" value="8. Logging&#xa;&#xa;All execution logs written to&#xa;CloudWatch Log Group" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="1300" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="ed-emailer-log-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-step8-box" target="ed-cloudwatch-box" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="290" y="1340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-end-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-cloudwatch-box" target="ed-more-events-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-more-events-decision" value="More&#xa;Events?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="485" y="1410" width="130" height="90" as="geometry" />
        </mxCell>
        <mxCell id="ed-loop-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#0000FF;" parent="1" source="ed-more-events-decision" target="ed-step2-box" edge="1">
          <mxGeometry x="-0.9608" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="180" y="1455" />
              <mxPoint x="180" y="320" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-finish-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="ed-more-events-decision" target="ed-end-node" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="ed-end-node" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="525" y="1530" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="ed-end-inner" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="533" y="1538" width="34" height="34" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-box" value="Legend" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="100" width="200" height="200" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-start" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="30" y="140" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-start-text" value="Start/End Node" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="60" y="135" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-process" value="Process" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="30" y="175" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-process-text" value="Activity/Process" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="120" y="175" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-decision" value="Decision" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="30" y="220" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-decision-text" value="Decision Point" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="120" y="225" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-legend-loop" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;strokeColor=#0000FF;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="30" y="280" as="sourcePoint" />
            <mxPoint x="110" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="ed-legend-loop-text" value="Loop/Iteration" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="120" y="265" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-notes-box" value="Key Notes:" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="330" width="160" height="310" as="geometry" />
        </mxCell>
        <mxCell id="ed-notes-text" value="• Real-time event response&lt;br&gt;&lt;br&gt;• EventBridge pattern&lt;br&gt;  matching required&lt;br&gt;&lt;br&gt;• Lambda cold start&lt;br&gt;  5-10s initial delay&lt;br&gt;&lt;br&gt;• Execution within seconds&lt;br&gt;  of event occurrence&lt;br&gt;&lt;br&gt;• Lambda runs in VPC&lt;br&gt;  (optional)&lt;br&gt;&lt;br&gt;• Automatic scaling&lt;br&gt;&lt;br&gt;• Event-driven costs&lt;br&gt;  (per invocation)&lt;div&gt;&lt;br/&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="20" y="380" width="140" height="240" as="geometry" />
        </mxCell>
        <mxCell id="ed-aws-services-box" value="AWS Services" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="680" width="160" height="240" as="geometry" />
        </mxCell>
        <mxCell id="ed-eventbridge-icon" value="" style="points=[];aspect=fixed;html=1;align=center;shadow=0;dashed=0;fillColor=#FF6A00;strokeColor=none;shape=mxgraph.alibaba_cloud.eventbridge;" parent="1" vertex="1">
          <mxGeometry x="30" y="715" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ed-eventbridge-text" value="EventBridge (Trigger)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="69" y="720" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-lambda-icon" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.lambda_function;" parent="1" vertex="1">
          <mxGeometry x="30" y="765" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ed-lambda-text" value="Lambda (Execution)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="73" y="770" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-s3-icon" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.bucket_with_objects;" parent="1" vertex="1">
          <mxGeometry x="30" y="815" width="40" height="41.6" as="geometry" />
        </mxCell>
        <mxCell id="ed-s3-text" value="S3 (Output Storage)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="72" y="820" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ed-sqs-icon" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.sqs;" parent="1" vertex="1">
          <mxGeometry x="30" y="870" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ed-sqs-text" value="SQS (Notifications)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="71" y="875" width="120" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="mgYV8gaQJksl6HbWAZ8v" name="Non Event Driven - Activity Diagram">
    <mxGraphModel dx="1482" dy="911" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1100" pageHeight="1400" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="activity-title" value="Cloud Custodian Non-Event Driven Policy Execution - Activity Diagram" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="100" y="20" width="900" height="40" as="geometry" />
        </mxCell>
        <mxCell id="start-node" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="525" y="80" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="step1-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="start-node" target="step1-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="step1-box" value="1. CI/CD Job Scheduling&#xa;&#xa;Schedule GitHub Actions/&#xa;Jenkins Job at desired intervals" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="160" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="step2-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="step1-box" target="step2-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="step2-box" value="2. Policy Discovery&#xa;&#xa;Locate all policy YAML files&#xa;in repository (policies/*.yml)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="270" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="step3-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="step2-box" target="policy-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="policy-decision" value="For Each&#xa;Policy File" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="380" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="step3-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="policy-decision" target="step3-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="step3-box" value="3. Policy Execution&#xa;&#xa;Run: custodian run -s &lt;output_dir&gt; &lt;policy_file&gt;&#xa;&#xa;Execute all policies in file,&#xa;apply filters and actions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="510" width="260" height="100" as="geometry" />
        </mxCell>
        <mxCell id="step4-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="step3-box" target="step4-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="step4-box" value="4. Output Storage&#xa;&#xa;Save execution results to&#xa;S3 output directory&#xa;(resource matches, action logs)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="420" y="640" width="260" height="90" as="geometry" />
        </mxCell>
        <mxCell id="step5-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="step4-box" target="notification-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="notification-decision" value="Policy Has&#xa;Notifications?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="760" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="step5-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="notification-decision" target="step5-box" edge="1">
          <mxGeometry x="-0.2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="step5-box" value="5. Notification Actions&#xa;&#xa;Send messages to configured&#xa;transport (SQS queue)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="765" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="step6-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="step5-box" target="step6-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="step6-box" value="6. Emailer Integration&#xa;&#xa;Emailer Lambda monitors SQS,&#xa;applies email templates,&#xa;sends via SES" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="760" y="885" width="240" height="90" as="geometry" />
        </mxCell>
        <mxCell id="step7-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="step6-box" target="step7-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="step5-no-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="notification-decision" target="step7-box" edge="1">
          <mxGeometry x="-0.7273" relative="1" as="geometry">
            <mxPoint x="350" y="810" as="targetPoint" />
            <Array as="points">
              <mxPoint x="320" y="810" />
              <mxPoint x="320" y="1040" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="step7-box" value="7. Logging &amp;amp; Monitoring&lt;br&gt;&lt;br&gt;• CI/CD job logs in CI system&lt;br&gt;• Custodian logs in S3 output directory" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;align=left;" parent="1" vertex="1">
          <mxGeometry x="420" y="1000" width="260" height="80" as="geometry" />
        </mxCell>
        <mxCell id="loop-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#0000FF;" parent="1" source="step7-box" target="policy-decision" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="220" y="1040" />
              <mxPoint x="220" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="loop-label" value="Next Policy" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#0000FF;fontStyle=2" parent="1" vertex="1">
          <mxGeometry x="150" y="700" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="end-arrow" value="No More&#xa;Policies" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="policy-decision" target="end-node" edge="1">
          <mxGeometry x="-0.8829" relative="1" as="geometry">
            <mxPoint x="750" y="430" as="targetPoint" />
            <Array as="points">
              <mxPoint x="1010" y="430" />
              <mxPoint x="1010" y="1200" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="end-node" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="525" y="1175" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="end-inner" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="533" y="1183" width="34" height="34" as="geometry" />
        </mxCell>
        <mxCell id="legend-box" value="Legend" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="100" width="200" height="200" as="geometry" />
        </mxCell>
        <mxCell id="legend-start" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="30" y="140" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-start-text" value="Start/End Node" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="60" y="135" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-process" value="Process" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="30" y="175" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-process-text" value="Activity/Process" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="120" y="175" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-decision" value="Decision" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="30" y="220" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="legend-decision-text" value="Decision Point" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="120" y="225" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-loop" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;strokeColor=#0000FF;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="30" y="280" as="sourcePoint" />
            <mxPoint x="110" y="280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-loop-text" value="Loop/Iteration" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="120" y="265" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="notes-box" value="Key Notes:" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="330" width="200" height="290" as="geometry" />
        </mxCell>
        <mxCell id="notes-text" value="• No Lambda functions&lt;br&gt;  are created&lt;br&gt;&lt;br&gt;• No EventBridge rules&lt;br&gt;  are needed&lt;br&gt;&lt;br&gt;• Policies run in CI/CD&lt;br&gt;  runner environment&lt;br&gt;&lt;br&gt;• Direct AWS API access&lt;br&gt;  via CLI credentials&lt;br&gt;&lt;br&gt;• Output saved to S3&lt;br&gt;&lt;br&gt;• Notifications via SQS&lt;br&gt;  (optional)&lt;div&gt;&lt;br/&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="20" y="380" width="130" height="220" as="geometry" />
        </mxCell>
        <mxCell id="aws-services-box" value="AWS Services" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="10" y="765" width="200" height="195" as="geometry" />
        </mxCell>
        <mxCell id="s3-icon" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.bucket_with_objects;" parent="1" vertex="1">
          <mxGeometry x="30" y="800" width="40" height="41.6" as="geometry" />
        </mxCell>
        <mxCell id="s3-text" value="S3 (Output Storage)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="80" y="805" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sqs-icon" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.sqs;" parent="1" vertex="1">
          <mxGeometry x="30" y="855" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sqs-text" value="SQS (Notifications)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="80" y="860" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="ses-icon" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.simple_email_service;" parent="1" vertex="1">
          <mxGeometry x="30" y="905" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="ses-text" value="SES (Email Delivery)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="80" y="910" width="120" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="single-lambda-architecture" name="Single Lambda Architecture">
    <mxGraphModel dx="1482" dy="911" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1400" pageHeight="900" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="sl-title" value="Cloud Custodian Single Lambda Event-Driven Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="100" y="10" width="1000" height="40" as="geometry" />
        </mxCell>
        <mxCell id="sl-aws-account" value="AWS Account" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_account;strokeColor=#CD2264;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#CD2264;dashed=0;" vertex="1" parent="1">
          <mxGeometry x="80" y="80" width="1240" height="740" as="geometry" />
        </mxCell>
        <mxCell id="sl-region" value="Region (us-east-1)" style="points=[[0,0],[0.25,0],[0.5,0],[0.75,0],[1,0],[1,0.25],[1,0.5],[1,0.75],[1,1],[0.75,1],[0.5,1],[0.25,1],[0,1],[0,0.75],[0,0.5],[0,0.25]];outlineConnect=0;gradientColor=none;html=1;whiteSpace=wrap;fontSize=12;fontStyle=0;container=1;pointerEvents=0;collapsible=0;recursiveResize=0;shape=mxgraph.aws4.group;grIcon=mxgraph.aws4.group_region;strokeColor=#00A4A6;fillColor=none;verticalAlign=top;align=left;spacingLeft=30;fontColor=#147EBA;dashed=1;" vertex="1" parent="sl-aws-account">
          <mxGeometry x="40" y="40" width="1160" height="660" as="geometry" />
        </mxCell>
        <mxCell id="sl-event-sources-box" value="Event Sources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;verticalAlign=top;fontSize=12;fontStyle=1;align=left;" vertex="1" parent="sl-region">
          <mxGeometry x="40" y="40" width="200" height="280" as="geometry" />
        </mxCell>
        <mxCell id="sl-cloudtrail" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#759C3E;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;aspect=fixed;shape=mxgraph.aws4.cloudtrail;" vertex="1" parent="sl-region">
          <mxGeometry x="60" y="70" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-cloudtrail-text" value="CloudTrail&#xa;(API Events)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="120" y="77.5" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sl-guardduty" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;aspect=fixed;shape=mxgraph.aws4.guardduty;" vertex="1" parent="sl-region">
          <mxGeometry x="60" y="130" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-guardduty-text" value="GuardDuty&#xa;(Findings)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="120" y="137.5" width="80" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sl-config" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#759C3E;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;aspect=fixed;shape=mxgraph.aws4.config;" vertex="1" parent="sl-region">
          <mxGeometry x="60" y="190" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-config-text" value="AWS Config&#xa;(Compliance)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="120" y="197.5" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sl-securityhub" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;aspect=fixed;shape=mxgraph.aws4.security_hub;" vertex="1" parent="sl-region">
          <mxGeometry x="60" y="250" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-securityhub-text" value="Security Hub&#xa;(CSPM)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="120" y="257.5" width="90" height="35" as="geometry" />
        </mxCell>
        <mxCell id="sl-eventbridge-arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;" edge="1" parent="sl-region" source="sl-cloudtrail" target="sl-eventbridge">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="320" y="250" as="targetPoint" />
            <Array as="points">
              <mxPoint x="280" y="95" />
              <mxPoint x="280" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-eventbridge-arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;" edge="1" parent="sl-region" source="sl-guardduty" target="sl-eventbridge">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="155" />
              <mxPoint x="280" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-eventbridge-arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;" edge="1" parent="sl-region" source="sl-config" target="sl-eventbridge">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="215" />
              <mxPoint x="280" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-eventbridge-arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#666666;strokeWidth=2;" edge="1" parent="sl-region" source="sl-securityhub" target="sl-eventbridge">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="280" y="275" />
              <mxPoint x="280" y="230" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-eventbridge" value="" style="points=[];aspect=fixed;html=1;align=center;shadow=0;dashed=0;fillColor=#FF6A00;strokeColor=none;shape=mxgraph.alibaba_cloud.eventbridge;" vertex="1" parent="sl-region">
          <mxGeometry x="335" y="200" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sl-eventbridge-text" value="EventBridge&#xa;Multi-Resource&#xa;Event Rule" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="305" y="270" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-lambda-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#ED7100;strokeWidth=3;" edge="1" parent="sl-region" source="sl-eventbridge" target="sl-lambda">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sl-lambda-arrow-text" value="1. Invoke" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#ED7100;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="430" y="205" width="70" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-lambda" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.lambda_function;" vertex="1" parent="sl-region">
          <mxGeometry x="560" y="196" width="68" height="68" as="geometry" />
        </mxCell>
        <mxCell id="sl-lambda-text" value="Single Lambda&#xa;cloud-custodian-executor&#xa;&#xa;• Event validation&#xa;• Policy mapping&#xa;• Policy execution" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="524" y="275" width="140" height="90" as="geometry" />
        </mxCell>
        <mxCell id="sl-s3-policy-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#7AA116;strokeWidth=2;dashed=1;" edge="1" parent="sl-region" source="sl-lambda" target="sl-s3-policies">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="594" y="440" />
              <mxPoint x="754" y="440" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-s3-policy-arrow-text" value="2. Fetch&#xa;policy-mapping.json&#xa;&amp; policy files" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=9;fontColor=#7AA116;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="614" y="380" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-cloudwatch-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#759C3E;strokeWidth=2;dashed=1;" edge="1" parent="sl-region" source="sl-lambda" target="sl-cloudwatch">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="594" y="80" />
              <mxPoint x="914" y="80" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-cloudwatch-arrow-text" value="4. Logs" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=9;fontColor=#759C3E;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="724" y="55" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-s3-policies" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.bucket_with_objects;" vertex="1" parent="sl-region">
          <mxGeometry x="720" y="480" width="68" height="70.72" as="geometry" />
        </mxCell>
        <mxCell id="sl-s3-policies-text" value="S3 Bucket&#xa;ysr95-custodian-policies&#xa;&#xa;• policy-mapping.json&#xa;• individual/*.yml" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="664" y="560" width="180" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sl-cloudwatch" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#E7157B;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.cloudwatch_logs;" vertex="1" parent="sl-region">
          <mxGeometry x="880" y="95" width="68" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-cloudwatch-text" value="CloudWatch Logs&#xa;/aws/lambda/&#xa;cloud-custodian-executor" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="829" y="30" width="170" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sl-resources-box" value="AWS Resources" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;verticalAlign=top;fontSize=12;fontStyle=1;align=left;" vertex="1" parent="sl-region">
          <mxGeometry x="880" y="200" width="240" height="280" as="geometry" />
        </mxCell>
        <mxCell id="sl-ec2" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.ec2_instance;" vertex="1" parent="sl-region">
          <mxGeometry x="900" y="230" width="48" height="48" as="geometry" />
        </mxCell>
        <mxCell id="sl-ec2-text" value="EC2 Instances" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="960" y="239" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-s3-resource" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#7AA116;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.bucket;" vertex="1" parent="sl-region">
          <mxGeometry x="900" y="290" width="48" height="49.92" as="geometry" />
        </mxCell>
        <mxCell id="sl-s3-resource-text" value="S3 Buckets" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="960" y="299.96" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-iam-resource" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#C925D1;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.user;" vertex="1" parent="sl-region">
          <mxGeometry x="900" y="355" width="48" height="48" as="geometry" />
        </mxCell>
        <mxCell id="sl-iam-resource-text" value="IAM Users/Roles" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="960" y="364" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-sg-resource" value="" style="sketch=0;outlineConnect=0;fontColor=#232F3E;gradientColor=none;fillColor=#ED7100;strokeColor=none;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;pointerEvents=1;shape=mxgraph.aws4.security_group;" vertex="1" parent="sl-region">
          <mxGeometry x="900" y="415" width="48" height="48" as="geometry" />
        </mxCell>
        <mxCell id="sl-sg-resource-text" value="Security Groups" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" vertex="1" parent="sl-region">
          <mxGeometry x="960" y="424" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-remediation-arrow" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#d79b00;strokeWidth=2;" edge="1" parent="sl-region" source="sl-lambda" target="sl-resources-box">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="750" y="230" />
              <mxPoint x="750" y="340" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sl-remediation-arrow-text" value="3. Remediate" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;fontColor=#d79b00;fontStyle=1;" vertex="1" parent="sl-region">
          <mxGeometry x="690" y="305" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sl-flow-box" value="Event Flow" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;verticalAlign=top;fontSize=13;fontStyle=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="100" y="850" width="600" height="170" as="geometry" />
        </mxCell>
        <mxCell id="sl-flow-text" value="1. Event Occurs → EventBridge rule matches event pattern&#xa;2. EventBridge → Invokes Single Lambda function&#xa;3. Lambda → Validates event using validator.py&#xa;4. Lambda → Fetches policy-mapping.json from S3&#xa;5. Lambda → Maps event type to appropriate policy file&#xa;6. Lambda → Downloads specific policy YAML from S3&#xa;7. Lambda → Executes Cloud Custodian policy&#xa;8. Lambda → Performs remediation actions on AWS resources&#xa;9. Lambda → Writes execution logs to CloudWatch" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="110" y="880" width="400" height="140" as="geometry" />
        </mxCell>
        <mxCell id="sl-benefits-box" value="Key Benefits" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;verticalAlign=top;fontSize=13;fontStyle=1;align=left;" vertex="1" parent="1">
          <mxGeometry x="740" y="850" width="580" height="170" as="geometry" />
        </mxCell>
        <mxCell id="sl-benefits-text" value="✓ Single Lambda function handles all events (simplified architecture)&#xa;✓ Dynamic policy loading from S3 (no Lambda redeployment for policy changes)&#xa;✓ Event-driven validation and mapping (validator.py + policy_executor.py)&#xa;✓ Multi-resource event support (S3, EC2, IAM, etc. in one EventBridge rule)&#xa;✓ Cost-effective (pay-per-invocation, no idle resources)&#xa;✓ Fast response time (real-time event processing)&#xa;✓ Centralized policy management (S3 bucket)&#xa;✓ Easy policy updates (upload new YAML to S3)&#xa;✓ Scalable (Lambda auto-scales based on event volume)" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="750" y="880" width="550" height="140" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="lambda-execution-steps" name="Policy Lambda - Execution Steps">
    <mxGraphModel dx="1042" dy="626" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1200" pageHeight="1700" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="le-title" value="Cloud Custodian Policy Lambda - Internal Execution Steps" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="150" y="20" width="900" height="40" as="geometry" />
        </mxCell>
        <mxCell id="le-start-node" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="575" y="80" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="le-step1-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-start-node" target="le-phase1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-phase1" value="INITIALIZATION PHASE" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="450" y="160" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="le-step1-arrow2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-phase1" target="le-step1-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step1-box" value="1. Lambda Invocation&#xa;&#xa;Receive EventBridge event payload&#xa;Initialize Python runtime" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="230" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-step2-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step1-box" target="le-step2-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step2-box" value="2. Parse Event&#xa;&#xa;Extract event details (event source,&#xa;resource IDs, action type)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="330" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-step3-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step2-box" target="le-step3-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step3-box" value="3. Load Policy YAML&#xa;&#xa;Read policy configuration from&#xa;embedded Lambda package" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="430" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-step4-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step3-box" target="le-step4-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step4-box" value="4. Initialize AWS Clients&#xa;&#xa;Create boto3 session and clients&#xa;(EC2, S3, IAM, etc.)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="530" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-phase2-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step4-box" target="le-phase2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-phase2" value="RESOURCE QUERY PHASE" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="450" y="635" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="le-step5-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-phase2" target="le-step5-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step5-box" value="5. Query Resources&#xa;&#xa;Fetch resources from AWS API&#xa;(e.g., describe_instances)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="700" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-phase3-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step5-box" target="le-phase3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-phase3" value="FILTERING PHASE" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="450" y="805" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="le-step6-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-phase3" target="le-filter-loop" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-filter-loop" value="For Each&#xa;Filter in&#xa;Policy" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="520" y="870" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="le-filter-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-filter-loop" target="le-step6-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step6-box" value="6. Apply Filter&#xa;&#xa;Evaluate filter logic (JMESPath,&#xa;value comparison, regex)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="1000" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-filter-back-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#0000FF;" parent="1" source="le-step6-box" target="le-filter-loop" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="800" y="1037" />
              <mxPoint x="800" y="920" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="le-filter-no-arrow" value="No More Filters" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-filter-loop" target="le-match-decision" edge="1">
          <mxGeometry x="-0.0667" y="-10" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="le-match-decision" value="Resources&#xa;Match All&#xa;Filters?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="210" y="870" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="le-match-no-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-match-decision" target="le-no-action-box" edge="1">
          <mxGeometry x="-0.7" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="le-no-action-box" value="No Action Taken&#xa;(Resources filtered out)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="50" y="885" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="le-skip-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;dashed=1;strokeColor=#999999;" parent="1" source="le-no-action-box" target="le-phase5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="110" y="1490" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="le-match-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-match-decision" target="le-phase4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-phase4" value="ACTION EXECUTION PHASE" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="140" y="1110" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="le-step7-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-phase4" target="le-action-loop" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-action-loop" value="For Each&#xa;Resource" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="210" y="1175" width="160" height="90" as="geometry" />
        </mxCell>
        <mxCell id="le-action-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-action-loop" target="le-step7-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step7-box" value="7. Execute Action&#xa;&#xa;Perform action on resource&#xa;(terminate, tag, modify, etc.)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="1295" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-step8-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step7-box" target="le-error-decision" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-error-decision" value="Action&#xa;Succeeded?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="530" y="1292.5" width="130" height="80" as="geometry" />
        </mxCell>
        <mxCell id="le-error-no-arrow" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-error-decision" target="le-error-box" edge="1">
          <mxGeometry x="-0.7" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="le-error-box" value="Log Error&#xa;(Continue or abort)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="710" y="1302.5" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="le-error-continue-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-error-box" target="le-action-loop" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="770" y="1220" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="le-error-yes-arrow" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-error-decision" target="le-action-loop" edge="1">
          <mxGeometry x="-0.9091" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="595" y="1220" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="le-action-no-arrow" value="No More&#xa;Resources" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-action-loop" target="le-phase5" edge="1">
          <mxGeometry x="-0.04" relative="1" as="geometry">
            <mxPoint as="offset" />
            <Array as="points">
              <mxPoint x="140" y="1220" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="le-phase5" value="OUTPUT &amp; LOGGING PHASE" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=14;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="140" y="1400" width="300" height="40" as="geometry" />
        </mxCell>
        <mxCell id="le-step8-arrow2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-phase5" target="le-step8-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step8-box" value="8. Write Results to S3&#xa;&#xa;Save execution summary,&#xa;resource list, action results" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="160" y="1470" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-step9-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step8-box" target="le-step9-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step9-box" value="9. Write CloudWatch Logs&#xa;&#xa;Log execution details,&#xa;errors, timing information" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="1470" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-step10-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step9-box" target="le-step10-box" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-step10-box" value="10. Return Response&#xa;&#xa;Return execution status and&#xa;summary to EventBridge" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="470" y="1575" width="260" height="75" as="geometry" />
        </mxCell>
        <mxCell id="le-end-arrow" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="le-step10-box" target="le-end-node" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="le-end-node" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="575" y="1670" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="le-end-inner" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="583" y="1678" width="34" height="34" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-box" value="Legend" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="880" y="160" width="280" height="260" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-start" value="" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#000000;" parent="1" vertex="1">
          <mxGeometry x="900" y="200" width="20" height="20" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-start-text" value="Start/End Node" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="930" y="195" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-phase" value="PHASE" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;fontSize=11;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="900" y="235" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-phase-text" value="Execution Phase" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1010" y="235" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-process" value="Process" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="900" y="280" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-process-text" value="Activity/Process" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1010" y="280" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-decision" value="Decision" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="900" y="325" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-decision-text" value="Decision Point" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1010" y="335" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-legend-loop" value="" style="endArrow=classic;html=1;rounded=0;dashed=1;strokeColor=#0000FF;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="900" y="395" as="sourcePoint" />
            <mxPoint x="1000" y="395" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="le-legend-loop-text" value="Loop/Iteration" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="1010" y="380" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="le-notes-box" value="Key Components:" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="880" y="450" width="280" height="310" as="geometry" />
        </mxCell>
        <mxCell id="le-notes-text" value="• Event Parser: Extracts event data&lt;br&gt;&lt;br&gt;• Policy Engine: Loads and interprets&lt;br&gt;  policy configuration&lt;br&gt;&lt;br&gt;• Resource Manager: Queries and&lt;br&gt;  retrieves AWS resources&lt;br&gt;&lt;br&gt;• Filter Chain: Applies sequential&lt;br&gt;  filter logic (JMESPath evaluation)&lt;br&gt;&lt;br&gt;• Action Executor: Performs policy&lt;br&gt;  actions with error handling&lt;br&gt;&lt;br&gt;• Output Writer: Saves results to S3&lt;br&gt;&lt;br&gt;• Logger: Writes CloudWatch logs&lt;div&gt;&lt;br/&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="890" y="500" width="200" height="240" as="geometry" />
        </mxCell>
        <mxCell id="le-tech-box" value="Technical Details:" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;align=left;verticalAlign=top;fontSize=12;fontStyle=1;" parent="1" vertex="1">
          <mxGeometry x="880" y="790" width="280" height="270" as="geometry" />
        </mxCell>
        <mxCell id="le-tech-text" value="• Python Runtime: 3.11&lt;br&gt;&lt;br&gt;• Boto3: AWS SDK for Python&lt;br&gt;&lt;br&gt;• JMESPath: Query language for&lt;br&gt;  filter evaluation&lt;br&gt;&lt;br&gt;• Error Handling: Try/catch with&lt;br&gt;  retry logic (exponential backoff)&lt;br&gt;&lt;br&gt;• Execution Timeout: Configurable&lt;br&gt;  (default 300-900s)&lt;br&gt;&lt;br&gt;• Memory: Configurable&lt;br&gt;  (default 512MB-1024MB)&lt;div&gt;&lt;br/&gt;&lt;/div&gt;" style="text;html=1;align=left;verticalAlign=top;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=10;" parent="1" vertex="1">
          <mxGeometry x="890" y="840" width="190" height="200" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
